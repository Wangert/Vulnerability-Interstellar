<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" style="height: 100%">
<head th:replace="base :: #public_head">

</head>
<body style="margin: 0;">
<nav th:replace="base :: #public_nav">
</nav>
<hr th:replace="base :: #public_hr"/>


<div style="width: 15%; height: 100%; float: left; background-color: rgba(105,105,105, 0.9)" id="personalCenterleft">
<ul class="nav nav-pills nav-stacked">
    <li role="presentation" id="bar-1"><a href="#" style="color: #5bc0de;">Personal Information<span class=" pull-right glyphicon glyphicon-user"></span></a></li>
    <li role="presentation" id="bar-2">
        <a style="color: #5bc0de" href="#docCollapse" class="nav-header collapsed" data-toggle="collapse" id="collapseParent" onclick="chevron_toggle()">Task Center<span class=" pull-right glyphicon glyphicon-list"></span></a>
        <ul id="docCollapse" class="nav nav-list collapse">
            <li><a th:href="@{personalCenterVulnerability}" style="color: rgba(240,255,255, 0.8)">Vulnerabilities</a></li>
            <li><a th:href="@{personalCenterPatch}" style="color: rgba(240,255,255, 0.8)">Patches</a></li>
        </ul>
    </li>
    <li role="presentation" id="bar-3" style="color: #5bc0de"><a th:href="@{publishVulnerability}" style="color: #5bc0de">Publish Vulnerability<span class=" pull-right glyphicon glyphicon-fire"></span></a></li>
    <li role="presentation" id="bar-4" style="color: #5bc0de"><a th:href="@{publishPatch}" style="color: #5bc0de">Publish Patch<span class=" pull-right glyphicon glyphicon-heart-empty"></span></a></li>
    <li role="presentation" id="bar-5">
        <a style="color: #5bc0de" href="#docCollapse1" class="nav-header collapsed" data-toggle="collapse" id="collapseParent1" onclick="chevron_toggle()">Assessment<span class=" pull-right glyphicon glyphicon-eye-open"></span></a>
        <ul id="docCollapse1" class="nav nav-list collapse">
            <li><a th:href="@{assessVulnerability}" style="color: rgba(240,255,255, 0.8)">Assess Vulnerability</a></li>
            <li><a th:href="@{assessPatch}" style="color: rgba(240,255,255, 0.8)">Assess Patch</a></li>
        </ul>
    </li>
    <li role="presentation" id="bar-6" style="color: #5bc0de"><a th:href="@{logout}" style="color: #5bc0de">Log Out<span class=" pull-right glyphicon glyphicon-off"></span></a></li>
</ul>
</div>


<div style="overflow-y: scroll; width: 84%; height: 100%; float: right; margin-right: 0.5%; background-color: rgba(248,248,255, 0.9)">

    <div class="page-header">
        <h1>Published Vulnerabilities <small><span class="glyphicon glyphicon-hand-right"></span>&nbsp;[[${session.loginUsername}]]</small></h1>
    </div>

    <ol class="breadcrumb" style="margin-top: 0">

        <li class="active" >Vulnerabilities</li>

    </ol>

    <div style="overflow-y: scroll; margin: 1%">
    <div class="row">

        <!--============循环遍历用户所拥有的漏洞================-->
        <div th:each="map, mapStat : ${userVulnerabilities}" class="col-sm-6 col-md-4">
            <div class="thumbnail" style="background-color: rgba(105,105,105, 0.9)">
                <div th:if="${map[fixDate]} eq 'not fix'" style="height: 60px; width: 100%; background-color: rgba(135,206,250, 0.9);"><span class="glyphicon glyphicon-send" style="font-size: xx-large; margin-top: 15px"></span></div>
                <div th:if="${map[fixDate]} ne 'not fix'" style="height: 60px; width: 100%; background-color: rgba(	0,250,154, 0.9);"><span class="glyphicon glyphicon-ok-circle" style="font-size: xx-large; margin-top: 15px"></span></div>

                <div class="caption">
                    <h5 style="color: white">[[${map.ipfsHash}]]</h5>
                    <p style="color: white">
                        <p style="color: white"><strong style="color:black;">Name:</strong>&nbsp;&nbsp;[[${map.vulnerabilityName}]]</p>
                        <p style="color: white"><strong style="color: black;">Submit Date:</strong>&nbsp;&nbsp;[[${map.releaseDate}]]</p>
                        <p style="color: white"><strong style="color: black;">Current State:</strong>&nbsp;&nbsp;[[${map.fixDate}]]</p>
                        <p style="color: white"><strong style="color: black;">Score:</strong>&nbsp;&nbsp;[[${map.score}]]</p>
                    </p>
                    <button type="button" style="background-color: rgba(0,191,255, 0.9)" class="btn btn-primary" data-toggle="modal" th:data-target="'#vulnerability' + ${mapStat.index}">View</button>
                    <div class="modal fade" th:id="'vulnerability' + ${mapStat.index}" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="page-header">
                                    <h1>Vulnerability Information <small>[[${map.vulnerabilityName}]]</small></h1>
                                </div>
                                <hr/>
                                <div>
                                    <p><h3>Vulnerability Publisher:</h3>[[${map.username}]]</p>
                                    <p><h3>Vulnerability Hash:</h3>[[${map.ipfsHash}]]</p>
                                    <p><h3>Vulnerability Submit Date:</h3>[[${map.releaseDate}]]</p>
                                    <p><h3>Current State:</h3>[[${map.fixDate}]]</p>
                                    <p><h3>Star:</h3>[[${map.star}]]</p>
                                    <p><h3>Score:</h3>[[${map.score}]]</p>
                                    <p><h3>Vulnerability Description:</h3>
                                    <textarea class="form-control" style="width: 70%; margin-left: 15%" rows="8" th:text="${map[description]}" disabled></textarea>
                                    </p>

                                    <br/>

                                    <div>
                                        <button type="button" class="btn btn-info" th:onclick="downloadVulnerability([[${map.ipfsHash}]]);">Download</button>
                                    </div>


                                    <a th:id="'download' + ${map[ipfsHash]}" th:href="@{/downloadVulnerability(fileName=${map[ipfsHash]})}" style="display: none"></a>

                                    <br/>
                                    <hr/>

                                </div>
                            </div>
                        </div>
                    </div>
                    <!--
                        <a href="#" class="btn btn-primary" role="button" style="background-color: rgba(0,191,255, 0.9)">View</a>
                        -->
                    <a th:href="@{/patchesOfVulnerability(vulnerabilityHash=${map[ipfsHash]})}" class="btn btn-default" role="button" style="background-color: rgba(240,255,255, 0.9)">Patches &nbsp;<span class="badge">[[${map.numberOfPatch}]]</span></a>
                </div>
            </div>
        </div>


    </div>

 </div>


</div>
</body>